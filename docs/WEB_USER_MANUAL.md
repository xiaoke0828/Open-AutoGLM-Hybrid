# AutoGLM Web 界面使用手册

欢迎使用 AutoGLM Web 控制台！本手册将帮助你快速上手通过浏览器控制手机。

## 📱 访问 Web 界面

### 本地访问（在家里）

打开浏览器访问：`http://localhost:5000`

### 公网访问（外网）

打开浏览器访问：`http://你的VPS_IP:8080`

例如：`http://123.456.789.0:8080`

---

## 🔑 首次登录

### 步骤 1：获取认证 Token

**方法 A：从 Mac 启动日志获取**

Mac 启动 Web 服务时会显示：
```
🔑 认证 Token：
   Ab3Cd9Ef2Gh5Jk8Lm1Pq4Rs7Tv0Wx6Yz
   (保存此 Token，用于 Web 界面登录)
```

**方法 B：从文件读取**

```bash
# 在 Mac 上执行
cd /Users/wk/Documents/Open-AutoGLM-Hybrid/web-server
cat .auth_token
```

### 步骤 2：输入 Token

1. 打开 Web 界面
2. 在"认证 Token"输入框中粘贴 Token
3. 点击"保存 Token"

Token 会保存在浏览器本地存储，下次访问无需重新输入。

---

## ✍️ 提交任务

### 基本流程

1. **输入任务描述**

   在"任务描述"文本框中输入你想让手机做什么，使用自然语言即可。

2. **点击提交**

   点击"🚀 提交任务"按钮。

3. **自动跳转**

   提交成功后会自动跳转到任务详情页，实时查看执行过程。

### 任务示例

#### 示例 1：发送微信消息

```
打开微信，给张三发消息说："今晚7点见"
```

#### 示例 2：浏览视频

```
打开抖音，搜索"猫咪视频"，点赞前3个视频
```

#### 示例 3：查看天气

```
打开天气应用，查看明天的天气预报
```

#### 示例 4：设置闹钟

```
打开时钟应用，设置明早7点的闹钟
```

#### 示例 5：发送邮件

```
打开邮件应用，给boss@company.com发邮件，主题是"周报"，内容是"本周工作已完成"
```

### 任务编写技巧

✅ **好的任务描述：**
- "打开微信，给张三发消息说晚上见"（明确、完整）
- "打开设置，关闭蓝牙"（步骤清晰）
- "打开淘宝，搜索'iPhone 15'，查看第一个商品详情"（有具体目标）

❌ **不好的任务描述：**
- "帮我发消息"（不明确给谁发、发什么）
- "打开设置"（没有后续操作）
- "买个手机"（太模糊，缺少具体步骤）

### 任务限制

- **最大长度**：500 字符
- **执行时间**：建议单个任务不超过 5 分钟
- **并发限制**：同时只能执行 1 个任务（自动排队）

---

## 📊 查看任务执行

### 任务详情页

提交任务后会自动跳转到任务详情页，包含两个区域：

#### 左侧：执行日志

**实时显示执行步骤：**
```
[15:30:12] 任务已提交到队列
[15:30:13] 开始执行任务...
[15:30:14] 正在连接手机...
[15:30:15] 正在截取屏幕...
[15:30:16] 正在分析屏幕内容...
[15:30:18] 正在执行操作: 打开微信
[15:30:20] 正在验证结果...
[15:30:21] ✅ 任务执行完成
```

**状态指示：**
- 🟡 **等待中**：任务在队列中等待
- 🔵 **执行中**：任务正在执行
- 🟢 **已完成**：任务成功完成
- 🔴 **失败**：任务执行失败（查看错误信息）

**任务信息：**
- 任务 ID（前 8 位）
- 创建时间
- 开始时间
- 完成时间
- 总耗时

#### 右侧：手机截图

**实时显示手机屏幕：**
- 任务执行时自动捕获手机屏幕
- 截图会实时更新
- 显示最后更新时间

**无截图时：**
- 显示占位图标
- 提示"任务执行时会自动捕获手机屏幕"

---

## 📜 历史记录

### 访问历史记录

点击顶部导航栏的"📋 历史记录"链接。

### 功能说明

**任务列表：**
- 显示所有历史任务（最近 50 条）
- 按时间倒序排列（最新的在前）

**筛选功能：**
- **全部**：显示所有任务
- **等待中**：正在队列中的任务
- **执行中**：正在执行的任务
- **已完成**：成功完成的任务
- **失败**：执行失败的任务

**任务卡片信息：**
- 任务状态和创建时间
- 任务描述
- 任务 ID
- 开始/完成时间
- 执行耗时
- 最新日志预览
- 错误信息（如果失败）

**查看详情：**
- 点击任务卡片跳转到详情页
- 可以查看完整日志和截图

---

## 🔄 实时监控

### 当前任务提示

在首页顶部，如果有任务正在执行，会显示：

```
⚙️ 正在执行任务
打开微信，给张三发消息
→ 查看详情
```

点击"查看详情"快速跳转到任务页面。

### 最近任务列表

在首页底部，显示最近 10 条任务：
- 快速查看任务状态
- 点击任务查看详情
- 支持刷新

---

## 🛠️ 常见问题

### Q1：提交任务后一直显示"等待中"？

**可能原因：**
1. 前面有任务在执行（系统限制同时只能执行 1 个任务）
2. Mac 服务未正常运行

**解决方法：**
- 等待前面的任务完成
- 检查 Mac 是否在运行 `start-web-frp.sh`

### Q2：任务执行失败怎么办？

**查看错误信息：**
- 在任务详情页底部会显示红色错误提示
- 根据错误信息排查问题

**常见错误：**
- "无法连接手机" → 检查手机 AutoGLM Helper 是否启动
- "API Key 无效" → 检查 Mac 端 `.env` 配置
- "超时" → 任务太复杂，拆分成多个简单任务

### Q3：Token 忘记了怎么办？

**方法 A：从 Mac 查看**
```bash
cd /Users/wk/Documents/Open-AutoGLM-Hybrid/web-server
cat .auth_token
```

**方法 B：重新生成**
```bash
cd /Users/wk/Documents/Open-AutoGLM-Hybrid/web-server
rm .auth_token
./start-web-frp.sh  # 重启时会生成新 Token
```

### Q4：手机截图不显示？

**可能原因：**
1. Android 版本过低（< 9.0）
2. 手机未授予截图权限
3. 任务还未执行到截图步骤

**解决方法：**
- 确保 Android 9.0+
- 检查 AutoGLM Helper 权限设置
- 等待任务执行

### Q5：外网访问很慢？

**优化建议：**
1. 检查 VPS 网络质量（ping 测试）
2. 更换 VPS 线路（BGP 线路更好）
3. 使用 CDN（如 Cloudflare）

### Q6：能同时提交多个任务吗？

**不能同时执行，但可以排队：**
- 系统限制同时只能执行 1 个任务
- 新提交的任务会自动加入队列
- 按提交顺序依次执行

**建议：**
- 将复杂任务拆分成多个简单任务
- 每个任务保持在 1-2 分钟内完成

---

## 🎯 最佳实践

### 1. 任务设计

**拆分复杂任务：**
```
❌ 不好：
"打开微信，给张三、李四、王五分别发消息"

✅ 好：
任务 1："打开微信，给张三发消息说晚上见"
任务 2："给李四发消息说明天见"
任务 3："给王五发消息说周末见"
```

**明确操作步骤：**
```
❌ 不好：
"帮我买个手机"

✅ 好：
"打开淘宝，搜索'iPhone 15'，按销量排序，查看第一个商品详情"
```

### 2. 定期检查

**建议每天检查：**
- 历史记录中的失败任务
- 分析失败原因
- 优化任务描述

### 3. 安全使用

**保护 Token：**
- 不要分享给他人
- 定期更换（每月一次）
- 使用后及时登出（公共设备）

**任务内容：**
- 不要在任务中包含密码
- 敏感操作手动完成
- 定期清理历史记录

---

## 📱 移动端优化

### 手机浏览器推荐

**iOS：**
- Safari（原生支持最好）
- Chrome

**Android：**
- Chrome
- Edge

### 添加到主屏幕

**iOS Safari：**
1. 访问 Web 界面
2. 点击"分享"按钮
3. 选择"添加到主屏幕"
4. 命名为"AutoGLM"

**Android Chrome：**
1. 访问 Web 界面
2. 点击右上角"⋮"
3. 选择"添加到主屏幕"

### 移动端快捷操作

**语音输入任务：**
- 在任务描述框点击麦克风图标
- 说出任务内容
- 点击提交

**快速查看：**
- 下拉刷新任务列表
- 侧滑返回上一页

---

## 🎉 高级技巧

### 1. 使用模板

创建常用任务模板，快速提交：

**早晨例行：**
```
打开今日头条，浏览今日要闻
```

**工作提醒：**
```
打开日历，查看今天的日程
```

**晚上休息：**
```
打开设置，开启勿扰模式
```

### 2. 批量操作

虽然不能同时执行，但可以快速提交多个任务：

1. 打开多个浏览器标签页
2. 每个标签页提交一个任务
3. 系统会自动排队执行

### 3. 定时任务（进阶）

通过脚本实现定时提交任务：

```bash
# 创建定时脚本
cat > ~/autoglm-schedule.sh << 'EOF'
#!/bin/bash
TOKEN="你的Token"
VPS_IP="你的VPS_IP"

curl -X POST "http://$VPS_IP:8080/api/tasks" \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"description":"打开闹钟，设置明早7点的闹钟"}'
EOF

chmod +x ~/autoglm-schedule.sh

# 添加到 crontab（每天晚上10点执行）
crontab -e
# 添加：0 22 * * * ~/autoglm-schedule.sh
```

---

## 📞 获取帮助

**遇到问题？**
1. 查看本手册的"常见问题"部分
2. 查看完整部署指南：`docs/FRP_WEB_DEPLOYMENT.md`
3. 提交 Issue：https://github.com/你的用户名/Open-AutoGLM-Hybrid/issues

**反馈建议：**
- 欢迎提出功能建议
- 分享你的使用心得
- 贡献任务模板

---

## 🌟 享受使用！

现在你已经掌握了 AutoGLM Web 界面的所有功能，开始享受自动化带来的便利吧！

**记得：**
- 🔒 保护好你的 Token
- 📝 使用清晰的任务描述
- 🎯 将复杂任务拆分成简单步骤
- 😊 遇到问题随时查阅本手册
